sonarr:
  #
  # IMPORTANT NOTE
  #
  # This chart inherits from our common library chart. You can check the default values/options here:
  # https://github.com/k8s-at-home/library-charts/tree/main/charts/stable/common/values.yaml
  #

  image:
    # -- image repository
    repository: ghcr.io/k8s-at-home/sonarr
    # @default -- chart.appVersion
    tag:
    # -- image pull policy
    pullPolicy: IfNotPresent

  # -- environment variables.
  # @default -- See below
  env:
    # -- Set the container timezone
    TZ: UTC

  # -- Configures service settings for the chart.
  # @default -- See values.yaml
  service:
    main:
      ports:
        http:
          port: 8989

  # -- Configure the ingresses for the chart here.
  # Additional ingresses can be added by adding a dictionary key similar to the 'main' ingress.
  # @default -- See below
  ingress:
    main:
      # -- Enables or disables the ingress
      enabled: false

      # -- Make this the primary ingress (used in probes, notes, etc...).
      # If there is more than 1 ingress, make sure that only 1 ingress is marked as primary.
      primary: true

      # -- Override the name suffix that is used for this ingress.
      nameOverride:

      # -- Provide additional annotations which may be required.
      annotations:
        {}
        # kubernetes.io/ingress.class: nginx
        # kubernetes.io/tls-acme: "true"

      # -- Provide additional labels which may be required.
      labels: {}

      # -- Set the ingressClass that is used for this ingress.
      # Requires Kubernetes >=1.19
      ingressClassName: # "nginx"

      ## Configure the hosts for the ingress
      hosts:
        - # -- Host address. Helm template can be passed.
          host: chart-example.local
          ## Configure the paths for the host
          paths:
            - # -- Path.  Helm template can be passed.
              path: /
              # -- Ignored if not kubeVersion >= 1.14-0
              pathType: Prefix
              service:
                # -- Overrides the service name reference for this path
                name:
                # -- Overrides the service port reference for this path
                port:

      # -- Configure TLS for the ingress. Both secretName and hosts can process a Helm template.
      tls: []
      #  - secretName: chart-example-tls
      #    hosts:
      #      - chart-example.local

  # -- Configures the probes for the main Pod.
  # @default -- See values.yaml
  probes:
    liveness:
      enabled: true
      ## Set this to true if you wish to specify your own livenessProbe
      custom: true
      ## The spec field contains the values for the default livenessProbe.
      ## If you selected custom: true, this field holds the definition of the livenessProbe.
      spec:
        exec:
          command:
            - /usr/bin/env
            - bash
            - -c
            - curl --fail localhost:8989/api/v3/system/status?apiKey=`IFS=\> && while
              read -d \< E C; do if [[ $E = "ApiKey" ]]; then echo $C; fi; done < /config/config.xml`
        failureThreshold: 5
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 10

  # -- Configure persistence settings for the chart under this key.
  ## Config persistence is required for the Prometheus exporter sidecar.
  # @default -- See values.yaml
  persistence:
    config:
      enabled: false

    media:
      enabled: false
      mountPath: /media

  metrics:
    # -- Enable and configure Exportarr sidecar and Prometheus serviceMonitor.
    # @default -- See values.yaml
    enabled: false
    serviceMonitor:
      interval: 3m
      scrapeTimeout: 1m
      labels: {}
    # -- Enable and configure Prometheus Rules for the chart under this key.
    # @default -- See values.yaml
    prometheusRule:
      enabled: false
      labels: {}
      # -- Configure additionial rules for the chart under this key.
      # @default -- See prometheusrules.yaml
      rules:
        []
        # - alert: SonarrDown
        #   annotations:
        #     description: Sonarr service is down.
        #     summary: Sonarr is down.
        #   expr: |
        #     sonarr_system_status == 0
        #   for: 5m
        #   labels:
        #     severity: critical
    exporter:
      image:
        # -- image repository
        repository: ghcr.io/onedr0p/exportarr
        # -- image tag
        tag: v1.6.2
        # -- image pull policy
        pullPolicy: IfNotPresent
      env:
        # -- metrics port
        port: 9794
        # -- Set to true to enable gathering of additional metrics (slow)
        additionalMetrics: false
        # -- Set to true to enable gathering unknown queue items
        unknownQueueItems: false
